(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{383:function(t,a,_){t.exports=_.p+"assets/img/cache.755f13e4.png"},523:function(t,a,_){"use strict";_.r(a);var s=_(42),i=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"一、为什么使用缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、为什么使用缓存"}},[t._v("#")]),t._v(" 一、为什么使用缓存")]),t._v(" "),s("p",[t._v("不缓存的话每次加载同一个且未被修改过的网页，都要浪费时间，浪费流量去加载。有了缓存的话，就可以用本地缓存显示")]),t._v(" "),s("h2",{attrs:{id:"二、缓存什么内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、缓存什么内容"}},[t._v("#")]),t._v(" 二、缓存什么内容？")]),t._v(" "),s("p",[t._v("缓存内容是一些不常修改的文件，例如，html，css，js等这些要用到，且很少修改的文件")]),t._v(" "),s("h2",{attrs:{id:"三、怎么实现缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、怎么实现缓存"}},[t._v("#")]),t._v(" 三、怎么实现缓存")]),t._v(" "),s("p",[t._v("在http里面通过请求头响应头来实现")]),t._v(" "),s("h3",{attrs:{id:"_3-1http缓存头部字段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1http缓存头部字段"}},[t._v("#")]),t._v(" 3.1HTTP缓存头部字段")]),t._v(" "),s("ul",[s("li",[t._v("cache-control\t请求/响应头，缓存控制字段，缓存不缓存他说了算\n"),s("ul",[s("li",[t._v("no-store：所有内容都不缓存")]),t._v(" "),s("li",[t._v("no-cache：缓存，但是浏览器使用缓存前，都会请求服务器判断资源是否最新")]),t._v(" "),s("li",[t._v("max-age = x(单位秒)请求缓存后的x秒不在发起请你去")]),t._v(" "),s("li",[t._v("s-maxage=x：代理服务器请求源站缓存后的x秒不在发起请求，只对CDN缓存有效")]),t._v(" "),s("li",[t._v("public：客户端和CDN都可以缓存")]),t._v(" "),s("li",[t._v("private：只有客户端可缓存")])])]),t._v(" "),s("li",[t._v("Expires 响应头，代表资源过期时间，服务端返回的，HTTP1.0的属性，与max-age共存下，优先级低")]),t._v(" "),s("li",[t._v("Last-Modified 响应头，资源最新修改时间，服务器告诉浏览器")]),t._v(" "),s("li",[t._v("if-Modified-Since 请求头，资源最新修改时间，浏览器告诉服务器，和上面是一对，两个会进行对比")]),t._v(" "),s("li",[t._v("Etag 响应头，资源标识，由服务器告诉浏览器，文件唯一标识")]),t._v(" "),s("li",[t._v("if-None-Match 请求头，缓存资源标识，由浏览器告诉服务器，和Etag是一对，他两个会进行对比")])]),t._v(" "),s("h3",{attrs:{id:"_3-2http缓存工作方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2http缓存工作方式"}},[t._v("#")]),t._v(" 3.2HTTP缓存工作方式")]),t._v(" "),s("h4",{attrs:{id:"场景一-让服务器与浏览器约定一个文件过期时间-expires"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景一-让服务器与浏览器约定一个文件过期时间-expires"}},[t._v("#")]),t._v(" 场景一：让服务器与浏览器约定一个文件过期时间——Expires")]),t._v(" "),s("ul",[s("li",[t._v("浏览器第一次请求文件，服务端返回文件并返回Expireres过期时间")]),t._v(" "),s("li",[t._v("在改时间内，就不要重新发起请求")]),t._v(" "),s("li",[t._v("时间过期了，重新发起")])]),t._v(" "),s("p",[t._v("缺点：")]),t._v(" "),s("ul",[s("li",[t._v("约定过期时间Expires时间到，但是请求文件未经修改、")]),t._v(" "),s("li",[t._v("还是要重新发起请求，不够智能")]),t._v(" "),s("li",[t._v("所以有了场景二")])]),t._v(" "),s("h4",{attrs:{id:"场景二-让服务器与浏览器在约定文件过期时间的基础上-加一个文件最新修改时间的对比-last-modified与if-modified-since"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景二-让服务器与浏览器在约定文件过期时间的基础上-加一个文件最新修改时间的对比-last-modified与if-modified-since"}},[t._v("#")]),t._v(" 场景二：让服务器与浏览器在约定文件过期时间的基础上，加一个文件最新修改时间的对比——Last-Modified与if-Modified-Since")]),t._v(" "),s("ul",[s("li",[t._v("浏览器向服务器请求资源，服务器返回 "),s("strong",[t._v("资源")]),t._v("+"),s("strong",[t._v("Expires")]),t._v("+"),s("strong",[t._v("Last-Modified")])]),t._v(" "),s("li",[t._v("情况一：Expires时间没到，就用本地缓存")]),t._v(" "),s("li",[t._v("情况二：Expires时间到了，浏览器就用if-Modified-Since进行对比\n"),s("ul",[s("li",[t._v("一样，则用本地缓存，并返回304")]),t._v(" "),s("li",[t._v("不一样，服务器返回最新资源+Expires+Last-Modified")])])])]),t._v(" "),s("h4",{attrs:{id:"场景三-在场景二的基础上加上文件唯一标识符etag"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景三-在场景二的基础上加上文件唯一标识符etag"}},[t._v("#")]),t._v(" 场景三：在场景二的基础上加上文件唯一标识符Etag")]),t._v(" "),s("ul",[s("li",[t._v("第一次请求，服务器返回Expires+资源+Etag")]),t._v(" "),s("li",[t._v("再次加载资源的时候，会用if-None-Match进行对比")]),t._v(" "),s("li",[t._v("如果文件未作修改，那么Etag是不会改变的，就直接使用缓存资源")])]),t._v(" "),s("p",[t._v("上面三种方式都有一个缺陷，就是文件发生修改了，但是Expires未到期，就无法请求最新的新资源。所以对缓存的方案进一步作出改进")]),t._v(" "),s("h3",{attrs:{id:"_3-3缓存改进方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3缓存改进方案"}},[t._v("#")]),t._v(" 3.3缓存改进方案")]),t._v(" "),s("h4",{attrs:{id:"改进一-md5-hash缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#改进一-md5-hash缓存"}},[t._v("#")]),t._v(" 改进一：md5/hash缓存")]),t._v(" "),s("ul",[s("li",[t._v("为静态文件添加MD5或者hash表示，解决浏览器无法跳过缓存过期时间主动感知文件变化问题")])]),t._v(" "),s("h4",{attrs:{id:"改进二-cdn缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#改进二-cdn缓存"}},[t._v("#")]),t._v(" 改进二：CDN缓存")]),t._v(" "),s("p",[t._v("内容分发网，依靠部署在各地边缘的服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使得用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率")]),t._v(" "),s("p",[s("img",{attrs:{src:_(383),alt:"cache"}})]),t._v(" "),s("h2",{attrs:{id:"四、内容协商机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、内容协商机制"}},[t._v("#")]),t._v(" 四、内容协商机制")])])}),[],!1,null,null,null);a.default=i.exports}}]);